@{
    ViewData["Title"] = "Home Page";
}


<video id="video" autoplay=" "  style='width:640px;height:480px;border:1px solid #ccc;'></video>

<button id='capture'>PICTURE</button> 

<canvas id="canvas" width="640" height="480"></canvas>

 <script type="text/javascript">


            // 访问用户媒体设备的兼容方法
            function getUserMedia(constraints, success, error) {
                if (navigator.mediaDevices.getUserMedia) {
                    // 最新的标准API
                    navigator.mediaDevices.getUserMedia(constraints)
                        .then(success).catch(error);
                } else if (navigator.webkitGetUserMedia) {
                    // Webkit核心浏览器
                    navigator.webkitGetUserMedia(constraints, success, error);
                } else
                    if (navigator.mozGetUserMedia) {
                        // Firefox浏览器
                        navigator.mozGetUserMedia(constraints, success, error);
                    } else if (navigator.getUserMedia) {
                        // 旧版API
                        navigator.getUserMedia(constraints, success, error);
                    }
            }
            var video = document.getElementById("video");// video元素
            var canvas = document.getElementById("canvas");// canvas元素
            var context = canvas.getContext("2d");

            // 成功的回调函数
            function success(stream) {
                var CompatibleURL = window.URL || window.webkitURL
                video.src = CompatibleURL.createObjectURL(stream);//将视频流设置为video元素的源
                video.play();// 播放视频
            }

            // 异常的回调函数
            function error(error) {
                console.log('访问用户媒体设备失败：', error.name, error.message);
            }

            if (navigator.mediaDevices.getUserMedia || navigator.getUserMedia ||
                navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {
                // 调用用户媒体设备，访问摄像头
                getUserMedia({ video: { width: 480, height: 320 } }, success, error);
            } else {
                alert('您的浏览器不支持访问用户媒体设备！');
            }

            // 绑定拍照按钮的点击事件
            document.getElementById("capture").addEventListener("click", function () {
                context.drawImage(video, 0, 0, 480, 320);
                // 将video画面在canvas上绘制出来
                var data = canvas.toDataURL('image/png', 1);    
                //将当前显示的图像传到Base64编码的字符串里
                document.getElementById('HiddenField1').value = data;  
                //将上面转换好的Base64编码传到C#的HiddenField里，方便后端取值
            });
            </script>
